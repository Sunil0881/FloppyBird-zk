function stringToBytes(s) {
  var data = new Uint8Array(s.length);
  for (var i = 0; i < s.length; i++) {
    data[i] = s.charCodeAt(i);
  }
  return data;
}

function toLE(val, bytes) {
  let flip = false;
  if (val < 0) {
    val = -val - 1;
    flip = true;
  }

  let r = new Uint8Array(bytes);
  for (var o = 0; o < bytes; ++o) {
    r[o] = val % 256;
    if (flip) {
      r[o] = ~r[o] & 0xff;
    }
    val /= 256;
  }
  return r;
}

function leToNumber(le) {
  let r = 0;
  let a = 1;
  le.forEach(x => {
    r += x * a;
    a *= 256;
  });
  return r;
}

module.exports = {
  stringToBytes,
  toLE,
  leToNumber
};
